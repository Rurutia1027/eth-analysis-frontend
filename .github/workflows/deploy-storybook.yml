name: Deploy Storybook to Vercel 

on: 
  push: 
   branches:
    - master 
   paths:
    - "eth-analysis-ui/src/stories/**/*.stories.@(ts|tsx)"
    - "eth-analysis-ui/src/stories/*.stories.@(ts|tsx)"
    - "eth-analysis-ui/.storybook/*"
  pull_request:
    branches:
      - "*"
    
jobs: 
  deploy-storybook: 
   runs-on: ubuntu-latest 
   steps:
    - name: Checkout repository 
      uses: actions/checkout@v4

    - name: Install Node.js 
      uses: actions/setup-node@v4 
      with: 
        node-version: 18 
    
    - name: Install dependencies 
      run: yarn install --frozen-lockfile 
      working-directory: eth-analysis-ui

    - name: Build Storybook 
      run: yarn build-storybook --output-dir=storybook-static 
      working-directory: eth-analysis-ui

    - name: Deploy Storybook to Vercel
      run: npx vercel --token=${{ secrets.VERCEL_TOKEN }} --prod -cwd --cwd eth-analysis-ui